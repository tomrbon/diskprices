<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Compare storage prices across retailers. Find the best deals on HDDs, SSDs, tape, RAM, and SD cards with price-per-TB calculations.">
  <meta name="theme-color" content="#0a0a0f">
  <meta name="color-scheme" content="dark">
  
  <!-- Open Graph / Social -->
  <meta property="og:title" content="{% if title %}{{ title }} | {% endif %}DiskPrices.info">
  <meta property="og:description" content="Compare storage prices across retailers. Find the best deals on HDDs, SSDs, tape, RAM, and SD cards.">
  <meta property="og:type" content="website">
  
  <title>{% if title %}{{ title }} | {% endif %}DiskPrices.info - Compare Storage Prices</title>
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@600;700&display=swap" rel="stylesheet">
  
  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üíæ</text></svg>">
  
  <link rel="stylesheet" href="{{ '/css/style.css' | url }}">
  
  <style>
    /* Reduce motion for users who prefer it */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
  </style>
</head>
<body>
  <a href="#main-content" class="sr-only">Skip to main content</a>
  
  <header class="site-header">
    <div class="container">
      <div class="header-content">
        <a href="/" class="logo" aria-label="DiskPrices.info - Home">
          <span class="logo-icon" aria-hidden="true">üíæ</span>
          <span class="logo-text">DiskPrices<span class="logo-tld">.info</span></span>
        </a>
        <nav class="main-nav" aria-label="Main navigation">
          <a href="#products" class="nav-link">
            <span>Products</span>
          </a>
          <a href="#about" class="nav-link">
            <span>About</span>
          </a>
          <a href="https://github.com" class="nav-link" target="_blank" rel="noopener noreferrer">
            <span>GitHub</span>
          </a>
        </nav>
      </div>
    </div>
  </header>

  <div class="page-wrapper">
    <!-- Popular Sidebar -->
    <aside class="popular-sidebar" id="popular-sidebar" aria-label="Most Popular Drives">
      <div class="sidebar-header">
        <h2 class="sidebar-title">
          <span class="sidebar-title-icon">üèÜ</span>
          Most Popular by Reviews
        </h2>
      </div>
      <ul class="popular-list">
        {% for product in products.products | sort(false, false, "reviews") | reverse | batch(12) | first %}
        <li class="popular-item">
          <a href="{{ product.url }}" 
             target="_blank" 
             rel="noopener" 
             class="popular-link">
            <div class="popular-name">
              <span class="popular-rank">{{ loop.index }}</span>
              {{ product.name }}
            </div>
            <div class="popular-rating">
              <div class="popular-stars" aria-label="{{ product.rating }} out of 5 stars">
                {% for i in [1, 2, 3, 4, 5] %}
                <svg class="popular-star {% if i > product.rating %}empty{% endif %}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                  <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                </svg>
                {% endfor %}
                <span class="popular-rating-value">{{ product.rating }}</span>
              </div>
              <span class="popular-reviews">{{ product.reviews | formatInt }} reviews</span>
            </div>
            <div class="popular-meta">
              <span class="popular-price">${{ product.price | formatNumber }}</span>
              <span class="popular-view-btn">
                View
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="7" y1="17" x2="17" y2="7"></line>
                  <polyline points="7 7 17 7 17 17"></polyline>
                </svg>
              </span>
            </div>
          </a>
        </li>
        {% endfor %}
      </ul>
    </aside>

    <main id="main-content" class="main-content">
      {{ content | safe }}
    </main>
  </div>

  <!-- Mobile Sidebar Toggle -->
  <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle popular products sidebar" aria-expanded="false">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
    </svg>
  </button>

  <footer class="site-footer">
    <div class="container">
      <div class="footer-content">
        <p class="footer-text">
          ¬© {{ year }} DiskPrices.info ‚Äî Compare storage prices across retailers.
        </p>
        <p class="footer-disclosure">
          <small>We may earn affiliate commissions from purchases made through links on this site. This helps support the site at no extra cost to you.</small>
        </p>
      </div>
    </div>
  </footer>

  <script>
    // Sidebar toggle for mobile
    (function() {
      const toggle = document.getElementById('sidebar-toggle');
      const sidebar = document.getElementById('popular-sidebar');
      
      if (toggle && sidebar) {
        toggle.addEventListener('click', function() {
          const isOpen = sidebar.classList.toggle('open');
          toggle.setAttribute('aria-expanded', isOpen.toString());
          
          // Update button icon
          if (isOpen) {
            toggle.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>';
          } else {
            toggle.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>';
          }
        });
        
        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(e) {
          if (window.innerWidth <= 1024) {
            if (!sidebar.contains(e.target) && !toggle.contains(e.target)) {
              sidebar.classList.remove('open');
              toggle.setAttribute('aria-expanded', 'false');
              toggle.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>';
            }
          }
        });
        
        // Close sidebar on Escape key
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape' && sidebar.classList.contains('open')) {
            sidebar.classList.remove('open');
            toggle.setAttribute('aria-expanded', 'false');
            toggle.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>';
            toggle.focus();
          }
        });
      }
    })();
  </script>
</body>
</html>
